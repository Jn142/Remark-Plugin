# 任务备注插件 (Task Notes Plugin)

## 📖 项目简介
任务备注插件是一个专为 [任务状态管理器](https://github.com/Jn142/-_task-status-manager) (⬅️点击可进入主程序界面)设计的独立扩展工具。它允许用户为任务管理系统中的各项任务添加详细的备注信息，而无需修改原始数据库，确保数据安全性和系统稳定性。


## ✨ 主要特性
* 🛡️ 安全独立 - 只读访问原数据库，备注数据独立存储

* 📝 智能备注 - 为任务添加、编辑、删除备注内容

* 🔄 孤儿处理 - 自动检测被删除任务的备注，支持重新绑定

* 🔍 强大搜索 - 支持按任务名称、ID、备注内容搜索

* 📊 实时统计 - 显示任务状态和备注统计信息

* 🎨 美观界面 - 现代化的渐变UI设计，用户体验友好

## 🚀 快速开始
### 方式一：使用预打包版本（推荐）
1. 下载插件
   * 从项目的 _**dist**_ 目录下载 _**任务备注插件.exe**_ 文件
2. 放置文件
   * 将 _**任务备注插件.exe**_ 放在与主程序相同的目录下
   * 确保目录结构如下：
  ```text
  你的程序目录/
  ├── 任务状态管理器.exe       # 主程序
  ├── 任务备注插件.exe         # 插件程序
  ├── task_manager.db         # 主程序数据库（运行主程序后自动生成）
  ├── notes_plugin.ini        # 扩展程序界面（运行扩展程序后自动生成）
  ├── task_notes.db           #扩展程序数据库（运行扩展程序后自动生成）
  ```
3. 运行插件
* 首次使用时，先双击_**任务状态管理器.exe**_ 启动主程序，以初始化数据库 _**task_manager.db**_ 。此后，插件程序仅依靠该数据库执行相关任务，主程序可不开启。
* 双击 任务备注插件.exe 启动程序
* 插件会自动检测主程序数据库并加载数据
### 方式二：从源码运行
#### 环境要求
* Python 3.6+
* PyQt5 5.15+
* psutil
#### 安装步骤
1. 安装依赖
```bash
pip install PyQt5 psutil
```
2. 放置文件
 *  将所有源码文件放在与主程序相同的目录下
 * 目录结构：
```
你的程序目录/
├── 任务状态管理器.exe      # 主程序
├── notes_plugin.py        # 插件主程序
├── notes_ui.py           # 界面文件
├── notes_db.py           # 数据库文件
├── notes_config.py       # 配置文件
├── task_manager.db       # 主程序数据库
└── ...其他文件
``` 
3. 运行程序
```
python notes_plugin.py
```
### 方式三：自行打包
1. 安装依赖
```
pip install PyQt5 psutil pyinstaller
```
2. 打包程序
```
pyinstaller build.spec
```
3. 获取可执行文件
* 打包后的程序在  _**dist/任务备注插件.exe**_

* 将其复制到主程序目录使用
## 🎯 使用指南
### 首次运行
1. **启动插件** - 双击 任务备注插件.exe

2. **自动检测** - 程序会自动检测主程序数据库并加载所有任务

3. **查看界面** - 主界面显示所有任务及其备注状态

### 基本操作
#### 添加备注
1. 在任务列表中找到需要添加备注的任务

2. 点击该任务行的"➕ 添加"按钮

3. 在弹出的对话框中输入备注内容

4. 点击"保存备注"完成添加

#### 管理备注
1. 找到已有备注的任务（显示"💬 有备注"）

2. 点击"📝 管理"按钮

3. 可以编辑备注内容或删除备注

#### 处理孤儿备注
当任务被删除但备注仍存在时：

1. 找到状态为"🗑️"的孤儿备注

2. 点击"🔄 绑定"按钮

3. 在弹出窗口中选择新的目标任务

4. 确认重新绑定

#### 搜索和筛选
* **搜索框** - 输入关键词搜索任务名称、ID或备注内容

* **状态筛选** - 下拉菜单筛选正常/孤儿状态

* **清空搜索** - 点击"🗑️ 清空"按钮重置搜索条件

### 界面说明
#### 状态标识
* ✅ **正常** - 任务存在且备注正常

*🗑️ **孤儿** - 原任务已被删除，备注需要重新绑定

*💬 **有备注** - 任务已添加备注内容

* 📝 **无备注** - 任务尚未添加备注

#### 统计信息
顶部统计栏显示：

* 总任务数、正常任务数、孤儿任务数

* 有备注任务数、无备注任务数

## ⚙️ 配置说明
程序首次运行时会自动创建配置文件 notes_plugin.ini：
```
[DATABASE]
original_db_path = task_manager.db    ; 原数据库路径
notes_db_path = task_notes.db         ; 备注数据库路径

[UI]
window_width = 1000                   ; 窗口宽度
window_height = 700                   ; 窗口高度
refresh_interval = 300                ; 刷新间隔(秒)
```
### 自定义配置

如果需要修改数据库路径或其他设置：

1. 关闭插件程序

2. 编辑  **notes_plugin.ini** 文件

3. 重新启动插件

## 🛠️ 故障排除
### 常见问题
**Q: 启动时提示"找不到原数据库文件"**
A: 确保插件程序与主程序在同一目录，且 task_manager.db 文件存在

**Q: 插件无法启动**
A: 检查是否安装了所有依赖（如果从源码运行），或尝试重新下载预打包版本

**Q: 备注数据丢失**
A: 备注数据独立存储在 task_notes.db 中，确保该文件未被删除

**Q: 界面显示异常**
A: 尝试重启程序，或检查显示器DPI设置
## 📁 文件说明
### 核心文件
* dist/任务备注插件.exe - 主程序（预打包版本）

* notes_plugin.py - 主程序源码

* notes_ui.py - 用户界面实现

* notes_db.py - 数据库操作逻辑

* notes_config.py - 配置管理

### 数据文件
* task_notes.db - 备注数据库（自动创建）

* notes_plugin.ini - 配置文件（自动创建）

### 打包文件
* build.spec - PyInstaller打包配置

* icon.ico - 程序图标

* requirements.txt - Python依赖列表

## 🔧 技术信息
### 系统架构
```text
任务状态管理器 (主程序)
        ↓ (只读访问)
任务备注插件 (本程序)
        ↓ (独立存储)
  备注数据库 (task_notes.db)
```

### 技术栈
* GUI框架: PyQt5

* 数据库: SQLite3

* 配置管理: configparser

* 进程检测: psutil

## 📄 许可证
本项目采用 MIT 许可证 - 查看 LICENSE 文件了解详情

**注意** : 本插件设计为与主程序配合使用，建议将插件程序放在与主程序相同的目录下以确保最佳兼容性。插件不会修改主程序的任何数据，所有备注信息独立存储，使用安全无忧。
